<Window x:Class="UniCast.App.Overlay.OverlayWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="UniCast Overlay"
        Width="400" Height="300"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize">

    <Border x:Name="MainBorder"
            Background="#E6181825"
            CornerRadius="10"
            BorderBrush="#3D3D4D"
            BorderThickness="1">

        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" 
                    Background="#2D2D3D" 
                    CornerRadius="6"
                    Padding="10,6"
                    Margin="0,0,0,8"
                    MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <Ellipse Width="8" Height="8" 
                                 x:Name="StatusIndicator"
                                 Fill="#10B981" Margin="0,0,8,0"/>
                        <TextBlock x:Name="TitleText"
                                   Text="UniCast" 
                                   Foreground="#FFFFFF"
                                   FontWeight="SemiBold"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button x:Name="MinimizeButton"
                                Content="─"
                                Width="24" Height="24"
                                Background="Transparent"
                                Foreground="#A0A0B0"
                                BorderThickness="0"
                                Click="MinimizeButton_Click"
                                Cursor="Hand"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Chat Messages -->
            <ScrollViewer Grid.Row="1" 
                          x:Name="ChatScrollViewer"
                          VerticalScrollBarVisibility="Hidden"
                          HorizontalScrollBarVisibility="Disabled">
                <ItemsControl x:Name="ChatItemsControl">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="#1D1D2D"
                                    CornerRadius="4"
                                    Padding="8,6"
                                    Margin="0,2">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Platform badge -->
                                    <Border Grid.Column="0"
                                            Background="{Binding PlatformColor}"
                                            CornerRadius="3"
                                            Padding="4,2"
                                            Margin="0,0,8,0"
                                            VerticalAlignment="Top">
                                        <TextBlock Text="{Binding PlatformShort}"
                                                   Foreground="White"
                                                   FontSize="10"
                                                   FontWeight="Bold"/>
                                    </Border>

                                    <!-- Message content -->
                                    <StackPanel Grid.Column="1">
                                        <TextBlock FontWeight="SemiBold" FontSize="12">
                                            <Run Text="{Binding DisplayName}" Foreground="#A855F7"/>
                                        </TextBlock>
                                        <TextBlock Text="{Binding Message}"
                                                   Foreground="#E0E0E0"
                                                   TextWrapping="Wrap"
                                                   FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- Break Mode Overlay -->
            <Border Grid.Row="1"
                    x:Name="BreakOverlay"
                    Background="#F0181825"
                    CornerRadius="6"
                    Visibility="Collapsed">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="☕" FontSize="48" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="BreakText"
                               Text="Mola"
                               Foreground="#FFFFFF"
                               FontSize="24"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               Margin="0,10,0,0"/>
                    <TextBlock x:Name="BreakTimerText"
                               Text="05:00"
                               Foreground="#A0A0B0"
                               FontSize="36"
                               FontFamily="Consolas"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Footer / Status Bar -->
            <Border Grid.Row="2" Margin="0,8,0,0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               x:Name="ViewerCountText"
                               Text="👥 0"
                               Foreground="#6A6A7A"
                               FontSize="11"
                               VerticalAlignment="Center"/>

                    <TextBlock Grid.Column="1"
                               x:Name="UptimeText"
                               Text="⏱ 00:00:00"
                               Foreground="#6A6A7A"
                               FontSize="11"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
